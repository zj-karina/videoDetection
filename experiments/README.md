# Сравнение различных моделей

| Модель   | Precision | Recall  | mAP50 | mAP50-95 |
|----------|-----------|---------|-------|----------|
| yolov5su | 0.96      | 0.871   | 0.94  | 0.748    |
| yolov8s  | 0.977     | 0.938   | 0.971 | 0.802    |
| yolov5x  | 0.977     | 0.944   | 0.979 | 0.836    |
| yolov8n  | 0.96      | 0.871   | 0.94  | 0.748    |

### Тестирование проводилось на
- NVIDIA Tesla V100-SXM2 (16GB)
- Intel Xeon E5-2680 v3 @ 2.50GHz
_________________________________

- NVIDIA Tesla T4
- Intel(R) Xeon(R) CPU @ 2.30GHz
_________________________________

### Преимущества YOLO

- **Высокая Скорость**: Обрабатывает до 45 кадров в секунду, что делает его идеальным для задач, требующих обработки в реальном времени.
- **Контекстная Точность**: Анализируя полное изображение, YOLO обеспечивает более высокую точность в контекстном обнаружении, с меньшим количеством ошибок.
- **Доступность и Документация**: Как открытый и хорошо задокументированный инструмент, YOLO легко использовать и интегрировать в различные проекты.
- **Обобщающая Способность**: Эффективно работает с новыми и незнакомыми данными, обладая хорошей обобщающей способностью.
- **Один Проход**: YOLO выполняет классификацию и локализацию объектов за один проход, что эффективнее методов, требующих множественных проходов.

### Ограничения YOLO

Несмотря на множество преимуществ, у YOLO есть и ограничения:

- **Обнаружение Мелких Объектов**: YOLO может испытывать сложности с обнаружением мелких объектов.
- **Объекты, Расположенные Близко**: Из-за способа деления изображения на сетку и предсказания одного объекта на ячейку, YOLO может неэффективно обрабатывать объекты, расположенные близко друг к другу.

Для задачи распознавания знаков на изображениях важно учитывать эти ограничения и проводить тщательное обучение и настройку модели, чтобы обеспечить хорошую производительность при обнаружении мелких объектов или объектов, расположенных близко друг к другу. Также может быть полезно использовать методы аугментации данных и разнообразные техники предварительной обработки изображений для улучшения результатов.




# Выбор метрик
| Метрика     | Плюсы                                                                                   | Минусы                                                                               |
|-------------|------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|
| Precision   | - Оценивает точность алгоритма обнаружения.<br/> - Помогает избегать ложных срабатываний. | - Может быть высоким при низкой полноте.<br/> - Не учитывает пропущенные объекты. |
| Recall      | - Оценивает полноту алгоритма обнаружения.<br/> - Помогает избегать пропущенных объектов. | - Может быть низким при высокой точности.<br/> - Может увеличивать ложные срабатывания. |
| mAP50       | - Учитывает точность и полноту при разных порогах IoU.<br/> - Обобщенная метрика.     | - Может быть недостаточно чувствительным к высоким порогам IoU.                   |
| mAP50-95    | - Учитывает точность и полноту в широком диапазоне порогов IoU.<br/> - Более жесткая метрика. | - Более требовательный и мог недооценить производительность.                 |

В задаче обнаружения дорожных знаков на дороге важно рассматривать все четыре метрики (Precision, Recall, mAP50 и mAP50-95) по нескольким причинам:
1. **Баланс точности и полноты:** Обнаружение дорожных знаков требует баланса между точностью (Precision) и полнотой (Recall). Высокая точность важна, чтобы избегать ложных срабатываний, которые могут привести к нежелательным действиям на дороге или отвлечению водителя. Полнота важна, чтобы обнаруживать все действительные дорожные знаки, чтобы обеспечить безопасность движения. Поэтому обе метрики важны для оценки эффективности алгоритма.
2. **Чувствительность к порогам IoU:** Метрика среднего значения Average Precision (mAP) с учетом разных порогов перекрытия (IoU) (например, mAP50) позволяет оценить производительность алгоритма при разных уровнях жесткости сравнения. Важно знать, как алгоритм справляется с разными степенями перекрытия объектов и как это влияет на его производительность.
3. **Жесткость сравнения:** Метрика среднего значения Average Precision в диапазоне IoU 0.5-0.95 (mAP50-95) более жесткая и требовательная. Она позволяет оценить производительность алгоритма в условиях более строгого сравнения объектов. Важно знать, как алгоритм справляется с точностью при более высоких степенях перекрытия.
4. **Обобщенная оценка производительности:** В задаче обнаружения дорожных знаков может быть различное сочетание желаемых характеристик, в зависимости от контекста и требований. Использование всех четырех метрик позволяет получить более полное представление о производительности алгоритма и выбрать наилучший баланс между точностью и полнотой в соответствии с конкретными потребностями.

# Выбор параметров.
Сначала использовали размер изображения 416 и на нем сравнивали различные подходы, после выбора лучшей модели использовали размер изображения 640
Процесс оптимизации остальных гиперпараметров показан в файле: hyperparams.ipynb

![image](https://github.com/zj-karina/videoDetection/assets/78540764/0b34cce0-c9d7-4218-9d85-64be6a39b43a)
![uniform_grid_combined_new_image](https://github.com/zj-karina/videoDetection/assets/78540764/bb5ef731-be91-4f9c-b79e-b5e45bd84922)



<p align="center"><b>Делаем разрешение больше и балансируем классы</b></p>

![image](https://github.com/zj-karina/videoDetection/assets/78540764/9311c1d7-9256-442d-8ab5-ec97c819e1ef)
![uniform_grid_combined_additional_image](https://github.com/zj-karina/videoDetection/assets/78540764/4a27367a-c40d-4beb-aab1-4e03e5f6b693)


# Выбор классов для распознавания

1. **Ограничение скорости (Speed Limit)**: Эти знаки определяют максимально допустимую скорость на определённых участках дороги, что критически важно для безопасности. Соблюдение этих ограничений помогает предотвратить аварии, снизить травматизм и обеспечить плавное движение транспорта.

2. **Знаки "Уступи дорогу" (Yield)**: Эти знаки регулируют приоритет на перекрёстках и в других точках слияния транспортных потоков. Они помогают избежать столкновений и способствуют более организованному и безопасному движению.

3. **Обязательные знаки (Mandatory Signs)**: Эти знаки указывают водителям на необходимость выполнения определённых действий, например, остановка на стоп-линии или включение фар в тёмное время суток. Соблюдение этих знаков улучшает безопасность и способствует предсказуемости и организованности движения.

4. **Другие знаки (Other Signs)**: В эту категорию входят знаки, предупреждающие о различных опасностях или указывающие на специфические правила движения, например, пересечение с железнодорожными путями, места для парковки, наличие школ и прочее. Они также важны для обеспечения безопасности и организации движения.

Эти классы знаков выбраны как наиболее важные, поскольку они напрямую влияют на безопасность и организацию дорожного движения. Их правильное соблюдение имеет решающее значение для предотвращения аварий и обеспечения эффективной работы дорожной инфраструктуры.





# Способы обработки данных с нескольких камер:

1) Используются все камеры одновременно, каждая обрабатывается отдельно, обеспечивая максимальное покрытие.
Метрики вычисляются отдельно для каждой камеры, затем агрегируются. Эффективность высока, но требуется больше ресурсов.

2) Селективное включение камер. Камеры активируются по определенным критериям (движение, освещение и т.д.), что снижает нагрузку на ресурсы.
Метрики оцениваются на основе событий, зафиксированных активированными камерами. Может быть снижена полнота обнаружения.

3) Временная синхронизация камер. Камеры работают в определенные временные интервалы, что оптимизирует использование ресурсов при переменном трафике.
Эффективность системы оценивается в разные временные промежутки, чтобы понять влияние синхронизации на метрики.

4) Интеграция данных с нескольких камер. Данные с разных камер объединяются для более полного анализа ситуации на дороге, требует сложной системы обработки.
   Метрики оцениваются на основе интегрированных данных, что может улучшить детекцию за счет более широкого покрытия.


